{% extends "layout.html" %}
{% block content %}
<style>
  :root{
    --bg:#f7f8fb; --card:#ffffff; --text:#0f172a; --muted:#475569;
    --primary:#0ea5e9; --border:#e2e8f0; --hover:#e6f6ff; --danger:#ef4444;
  }
  .page{max-width:720px;margin:0 auto;}
  .head{display:flex;justify-content:space-between;align-items:center;margin:8px 0 16px}
  .title{font-size:22px;font-weight:800;margin:0}
  .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);background:#fff;
       color:var(--text);padding:8px 12px;border-radius:12px;cursor:pointer;text-decoration:none}
  .btn:hover{background:var(--hover);border-color:#bfe7ff}
  .btn-primary{background:var(--primary);color:#fff;border-color:transparent}
  .btn-primary:hover{filter:brightness(0.95)}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  .field{display:flex;flex-direction:column;gap:6px}
  label{font-size:12px;color:var(--muted);font-weight:700}
  input, select{height:40px;border:1px solid var(--border);border-radius:10px;padding:0 12px;font-size:14px}
  input:focus, select:focus{outline:none;border-color:#bfe7ff;box-shadow:0 0 0 3px #e6f6ff}
  .hint{font-size:12px;color:var(--muted)}
  .actions{display:flex;justify-content:flex-end;gap:10px;margin-top:16px}
  @media (max-width:800px){ .grid{grid-template-columns:1fr;} }
</style>

<div class="page">
  <div class="head">
    <h1 class="title">{{ 'Create User' if mode=='create' else 'Edit User' }}</h1>
    <a class="btn" href="{{ url_for('users.list_users') }}">Back to list</a>
  </div>

  <form method="post" class="card">
    <div class="grid">
      <div class="field">
        <label>Username *</label>
        <input name="username" type="text" required
               value="{{ row.username if row else '' }}" {{ 'readonly' if mode=='edit' }}>
      </div>

      <div class="field">
        <label>Password {{ '(leave empty to keep)' if mode=='edit' else '*' }}</label>
        <input name="password" type="password" {{ 'required' if mode=='create' }}>
        {% if mode=='edit' %}<div class="hint">Şifreyi değiştirmek istemiyorsan boş bırak.</div>{% endif %}
      </div>

      <div class="field">
        <label>Full Name</label>
        <input name="full_name" type="text" value="{{ row.full_name if row else '' }}">
      </div>

      <div class="field">
        <label>Email</label>
        <input name="email" type="email" value="{{ row.email if row else '' }}">
      </div>

      <div class="field">
        <label>Role</label>
        <select name="role">
          {% for opt in ['admin','analyst','viewer'] %}
            <option value="{{ opt }}" {{ 'selected' if row and row.role==opt else '' }}>{{ opt|capitalize }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="field">
        <label>Status</label>
        <select name="status">
          {% for opt in ['active','inactive','locked'] %}
            <option value="{{ opt }}" {{ 'selected' if row and row.status==opt else '' }}>{{ opt|capitalize }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="actions">
      <a class="btn" href="{{ url_for('users.list_users') }}">Cancel</a>
      <button type="submit" class="btn btn-primary">Save</button>
    </div>
  </form>
</div>
{% endblock %}
